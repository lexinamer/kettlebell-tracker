<template>
  <Transition name="drawer-left">
    <div v-if="isOpen" class="drawer-left-overlay" @click="$emit('close')">
      <div class="drawer-left" @click.stop>
        <div class="drawer-left-header">
          <div class="brand">
            <svg width="95" height="121" viewBox="0 0 95 121" fill="none" xmlns="http://www.w3.org/2000/svg" class="logo">
              <path d="M85.106 49.2251C86.2526 43.6243 86.1388 37.8385 84.7729 32.2871C83.4071 26.7357 80.8233 21.5577 77.2088 17.1283C73.5944 12.6989 69.0398 9.12913 63.8751 6.6776C58.7105 4.22607 53.0651 2.95422 47.3481 2.95422C41.6312 2.95422 35.9858 4.22607 30.8212 6.6776C25.6565 9.12913 21.1019 12.6989 17.4875 17.1283C13.873 21.5577 11.2892 26.7357 9.92335 32.2871C8.55748 37.8385 8.44372 43.6243 9.59034 49.2251C5.28661 55.9905 2.87972 63.7881 2.62138 71.8022C2.36304 79.8164 4.26274 87.7528 8.12181 94.7814C11.9809 101.81 17.6576 107.673 24.5582 111.756C31.4588 115.84 39.3298 117.994 47.3481 117.994C55.3665 117.994 63.2375 115.84 70.1381 111.756C77.0387 107.673 82.7154 101.81 86.5745 94.7814C90.4336 87.7528 92.3333 79.8164 92.0749 71.8022C91.8166 63.7881 89.4097 55.9905 85.106 49.2251ZM47.3761 11.1876C55.1677 11.1747 62.6606 14.1842 68.2786 19.5831C73.8965 24.9819 77.2016 32.3493 77.4985 40.1352C69.2588 32.6355 58.5178 28.4791 47.3761 28.4791C36.2344 28.4791 25.4934 32.6355 17.2538 40.1352C17.5507 32.3493 20.8557 24.9819 26.4737 19.5831C32.0916 14.1842 39.5845 11.1747 47.3761 11.1876Z" fill="#7C3AED"/>
              <path d="M47.3762 120.545C38.9923 120.515 30.7653 118.269 23.5296 114.034C16.2938 109.799 10.3065 103.726 6.17475 96.4306C2.04298 89.1354 -0.0863445 80.8774 0.00268131 72.4939C0.0917071 64.1103 2.39592 55.8994 6.68167 48.6936C6.25831 46.2644 6.0431 43.8036 6.03839 41.3378C6.03839 30.3743 10.3936 19.8599 18.146 12.1076C25.8983 4.35522 36.4127 0 47.3762 0C58.3397 0 68.8541 4.35522 76.6065 12.1076C84.3588 19.8599 88.714 30.3743 88.714 41.3378C88.7093 43.8036 88.4941 46.2644 88.0707 48.6936C92.3565 55.8994 94.6607 64.1103 94.7497 72.4939C94.8387 80.8774 92.7094 89.1354 88.5777 96.4306C84.4459 103.726 78.4586 109.799 71.2228 114.034C63.9871 118.269 55.7602 120.515 47.3762 120.545ZM47.3762 5.59375C42.0617 5.59826 36.815 6.78686 32.0175 9.07314C27.2199 11.3594 22.9921 14.6859 19.6412 18.8109C16.2903 22.9359 13.9007 27.7556 12.6459 32.9198C11.3911 38.0841 11.3028 43.463 12.3873 48.6656C12.5315 49.3802 12.391 50.1228 11.9957 50.7353C7.95459 57.0771 5.69231 64.3886 5.44565 71.9045C5.199 79.4204 6.97703 86.8644 10.5937 93.4575C14.2103 100.051 19.5326 105.55 26.0036 109.381C32.4745 113.212 39.8563 115.234 47.3762 115.234C54.8961 115.234 62.2779 113.212 68.7488 109.381C75.2198 105.55 80.5421 100.051 84.1587 93.4575C87.7754 86.8644 89.5534 79.4204 89.3068 71.9045C89.0601 64.3886 86.7978 57.0771 82.7567 50.7353C82.3614 50.1228 82.2209 49.3802 82.3651 48.6656C83.4496 43.463 83.3613 38.0841 82.1065 32.9198C80.8517 27.7556 78.4621 22.9359 75.1112 18.8109C71.7603 14.6859 67.5325 11.3594 62.7349 9.07314C57.9374 6.78686 52.6907 5.59826 47.3762 5.59375ZM77.4985 42.932C76.7957 42.9372 76.1167 42.6776 75.5967 42.2048C67.889 35.155 57.8217 31.2453 47.3762 31.2453C36.9307 31.2453 26.8634 35.155 19.1557 42.2048C18.7487 42.5836 18.238 42.8323 17.6889 42.9195C17.1398 43.0066 16.5771 42.928 16.0729 42.6939C15.5686 42.4598 15.1455 42.0807 14.8577 41.605C14.5699 41.1293 14.4304 40.5786 14.457 40.0233C14.8073 31.5274 18.4287 23.4958 24.5639 17.6084C30.6992 11.7209 38.8731 8.43337 47.3762 8.43337C55.8794 8.43337 64.0532 11.7209 70.1885 17.6084C76.3237 23.4958 79.9451 31.5274 80.2954 40.0233C80.3187 40.5771 80.177 41.1253 79.8882 41.5983C79.5993 42.0714 79.1765 42.448 78.6732 42.6803C78.3045 42.8483 77.9037 42.9342 77.4985 42.932ZM47.3762 25.6473C56.7113 25.634 65.8409 28.3884 73.6109 33.5625C71.9398 27.9004 68.4817 22.931 63.7533 19.3964C59.0248 15.8618 53.2797 13.9519 47.3762 13.9519C41.4727 13.9519 35.7276 15.8618 30.9991 19.3964C26.2707 22.931 22.8126 27.9004 21.1415 33.5625C28.9116 28.3884 38.0411 25.634 47.3762 25.6473Z" fill="#3C029F"/>
              <path d="M77.4984 42.9321C76.7956 42.9373 76.1166 42.6777 75.5965 42.2049C67.8888 35.1551 57.8216 31.2454 47.376 31.2454C36.9305 31.2454 26.8633 35.1551 19.1556 42.2049C18.7485 42.5837 18.2378 42.8324 17.6887 42.9196C17.1396 43.0067 16.577 42.9281 16.0727 42.694C15.5684 42.4599 15.1454 42.0808 14.8575 41.6051C14.5697 41.1294 14.4302 40.5787 14.4568 40.0234C14.8071 31.5275 18.4285 23.4959 24.5638 17.6085C30.699 11.721 38.8729 8.43347 47.376 8.43347C55.8792 8.43347 64.0531 11.721 70.1883 17.6085C76.3235 23.4959 79.945 31.5275 80.2953 40.0234C80.3186 40.5772 80.1768 41.1254 79.888 41.5984C79.5992 42.0715 79.1763 42.4481 78.6731 42.6804C78.3044 42.8484 77.9036 42.9343 77.4984 42.9321ZM47.376 25.6474C56.7112 25.6341 65.8407 28.3885 73.6107 33.5626C71.9396 27.9005 68.4816 22.9311 63.7531 19.3965C59.0246 15.8619 53.2796 13.952 47.376 13.952C41.4725 13.952 35.7274 15.8619 30.999 19.3965C26.2705 22.9311 22.8124 27.9005 21.1414 33.5626C28.9114 28.3885 38.0409 25.6341 47.376 25.6474Z" fill="#3C029F"/>
              <path d="M77.4985 42.9321C76.7957 42.9373 76.1167 42.6777 75.5966 42.2049C67.8889 35.1551 57.8216 31.2454 47.3761 31.2454C36.9306 31.2454 26.8633 35.1551 19.1557 42.2049C18.7486 42.5837 18.2379 42.8324 17.6888 42.9196C17.1397 43.0067 16.5771 42.9281 16.0728 42.694C15.5685 42.4599 15.1454 42.0808 14.8576 41.6051C14.5698 41.1294 14.4303 40.5787 14.4569 40.0234C14.8072 31.5275 18.4286 23.4959 24.5639 17.6085C30.6991 11.721 38.873 8.43347 47.3761 8.43347C55.8793 8.43347 64.0532 11.721 70.1884 17.6085C76.3236 23.4959 79.9451 31.5275 80.2953 40.0234C80.3187 40.5772 80.1769 41.1254 79.8881 41.5984C79.5993 42.0715 79.1764 42.4481 78.6732 42.6804C78.3044 42.8484 77.9036 42.9343 77.4985 42.9321ZM47.3761 25.6474C56.7112 25.6341 65.8408 28.3885 73.6108 33.5626C71.9397 27.9005 68.4817 22.9311 63.7532 19.3965C59.0247 15.8619 53.2796 13.952 47.3761 13.952C41.4726 13.952 35.7275 15.8619 30.9991 19.3965C26.2706 22.9311 22.8125 27.9005 21.1414 33.5626C28.9115 28.3885 38.041 25.6341 47.3761 25.6474ZM49.9772 108.267H49.8094C16.2749 106.337 13.8136 75.3759 13.8136 75.0682C13.7916 74.7009 13.8421 74.3329 13.9623 73.9851C14.0825 73.6374 14.27 73.3167 14.5141 73.0414C14.7583 72.7661 15.0542 72.5416 15.3851 72.3807C15.716 72.2197 16.0754 72.1256 16.4427 72.1035C16.81 72.0815 17.178 72.132 17.5258 72.2522C17.8735 72.3724 18.1942 72.5599 18.4695 72.8041C18.7448 73.0482 18.9693 73.3442 19.1303 73.6751C19.2912 74.006 19.3853 74.3653 19.4074 74.7326C19.4074 75.7954 21.533 101.051 50.173 102.701C50.9148 102.724 51.6173 103.04 52.1261 103.58C52.6349 104.12 52.9082 104.84 52.886 105.582C52.8637 106.324 52.5477 107.026 52.0075 107.535C51.4672 108.044 50.747 108.317 50.0052 108.295L49.9772 108.267Z" fill="#3C029F"/>
             </svg>
            <span>Bell Track</span>
          </div>
          <button @click="$emit('close')" class="btn-icon tertiary icon-sm">
            <X />
          </button>
        </div>
        
        <div class="drawer-body">
          <nav class="drawer-nav">
            <router-link to="/workouts" @click="$emit('close')" class="drawer-nav-item" active-class="active">
              <WeightTilde />
              <span>Workouts</span>
            </router-link>
            
            <router-link to="/templates" @click="$emit('close')" class="drawer-nav-item" active-class="active">
              <FileText />
              <span>Block Templates</span>
            </router-link>
            
            <router-link to="/settings" @click="$emit('close')" class="drawer-nav-item" active-class="active">
              <Settings />
              <span>Settings</span>
            </router-link>

            <button @click="handleLogout" class="drawer-nav-item logout">
              <LogOut />
              <span>Log Out</span>
            </button>
          </nav>

          <button @click="handleLogWorkout" class="drawer-nav-item primary drawer-btn cta">
            <Plus />
            <span>Log Workout</span>
          </button>
        </div>
      </div>
    </div>
  </Transition>
</template>

<script setup>
import { useRouter } from 'vue-router'
import { FileText, Settings, Plus, LogOut, X, WeightTilde } from 'lucide-vue-next'
import { useAuthStore } from '@/stores/authStore'

defineProps({
  isOpen: {
    type: Boolean,
    required: true
  }
})

const emit = defineEmits(['close'])
const router = useRouter()
const authStore = useAuthStore()

const handleLogWorkout = () => {
  router.push('/workouts/new')
  emit('close')
}

const handleLogout = async () => {
  await authStore.logout()
  emit('close')
  router.push('/login')
}
</script>